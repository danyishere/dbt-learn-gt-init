semantic_models:
- name: semantic_fct_orders
  description: An order table that gives payment details for analysis.
  model: ref('fct_orders')

  entities:
  - name: order_id
    type: primary
  - name: customer_id
    type: foreign


  dimensions:
  - name: order_status
    type: categorical
  - name: order_date
    type: time
    time_grains:
    - day
    - week
    - month
    - quarter
    - year
  
  measures:
  - name: total_amount
    description: Total amount of orders
    agg: sum
    expr: amount
  - name: true_total_amount
    agg: sum
    expr: case when order_status != 'returned' then amount else 0 end
  - name: avg_amount
    agg: average
    expr: amount
  - name: min_order_amount
    agg: min
    expr: amount